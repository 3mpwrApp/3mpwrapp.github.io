!function(){"use strict";const e=document.getElementById("contact-form"),t=document.getElementById("submit-btn"),n=document.getElementById("form-messages"),a=document.getElementById("message"),o=document.getElementById("message-count"),s="3mpwr_contact_form_draft";let r,i=!1;function l(){if(!e)return;const t={name:document.getElementById("name")?.value||"",email:document.getElementById("email")?.value||"",subject:document.getElementById("subject")?.value||"",message:document.getElementById("message")?.value||"",timestamp:(new Date).toISOString()};if(t.name||t.email||t.message)try{localStorage.setItem(s,JSON.stringify(t)),i=!0,function(){const e=document.createElement("div");e.className="autosave-indicator",e.textContent="💾 Draft saved",e.style.cssText="position: fixed; bottom: 20px; right: 20px; background: #4caf50; color: white; padding: 0.75rem 1.5rem; border-radius: 6px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 1000; animation: fadeInOut 2s ease;",e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),document.body.appendChild(e),setTimeout(()=>{e.remove()},2e3)}()}catch(e){}}function c(e){const t=document.getElementById(e.id+"-error");let n=!0,a="";return e.hasAttribute("required")&&!e.value.trim()?(n=!1,a="This field is required"):"email"===e.type&&e.value?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value)||(n=!1,a="Please enter a valid email address"):"SELECT"!==e.tagName||e.value||(n=!1,a="Please select an option"),n?(e.setAttribute("aria-invalid","false"),e.classList.remove("field-error"),t&&(t.textContent="",t.style.display="none")):(e.setAttribute("aria-invalid","true"),e.classList.add("field-error"),t&&(t.textContent=a,t.style.display="block")),n}function m(e,t){n&&(n.textContent=e,n.className="form-messages "+t,n.style.display="block",n.scrollIntoView({behavior:"smooth",block:"nearest"}),"success"===t&&setTimeout(()=>{n.style.display="none"},1e4))}function d(){e&&(a&&o&&a.addEventListener("input",function(){const e=this.value.length;o.textContent=e+" character"+(1!==e?"s":"")}),e&&e.querySelectorAll("input, select, textarea").forEach(e=>{e.addEventListener("input",function(){clearTimeout(r),r=setTimeout(l,1e4)})}),["name","email","subject","message"].forEach(e=>{const t=document.getElementById(e);t&&(t.addEventListener("blur",function(){c(this)}),t.addEventListener("input",function(){"true"===this.getAttribute("aria-invalid")&&c(this)}))}),e&&(e.addEventListener("submit",function(n){n.preventDefault();let a=!0;if(["name","email","subject","message"].forEach(e=>{const t=document.getElementById(e);t&&!c(t)&&(a=!1)}),!a){m("Please correct the errors before submitting","error");const t=e.querySelector('[aria-invalid="true"]');return void(t&&t.focus())}t.disabled=!0,t.querySelector(".btn-text").textContent="Sending...",t.querySelector(".btn-spinner").style.display="inline";const r=new FormData(e);fetch(e.action,{method:"POST",body:r,headers:{Accept:"application/json"}}).then(t=>{if(!t.ok)throw new Error("Form submission failed");m("✅ Message sent successfully! We'll get back to you within 24 hours.","success"),e.reset(),o&&(o.textContent="0 characters"),localStorage.removeItem(s),i=!1}).catch(e=>{m("❌ Oops! There was a problem sending your message. Please try again or email us directly at empowrapp08162025@gmail.com","error")}).finally(()=>{t.disabled=!1,t.querySelector(".btn-text").textContent="Send Message",t.querySelector(".btn-spinner").style.display="none"})}),e.addEventListener("reset",function(){localStorage.removeItem(s),i=!1,["name","email","subject","message"].forEach(e=>{const t=document.getElementById(e);if(t){t.setAttribute("aria-invalid","false"),t.classList.remove("field-error");const e=document.getElementById(t.id+"-error");e&&(e.textContent="",e.style.display="none")}}),o&&(o.textContent="0 characters")})),window.addEventListener("beforeunload",function(e){i&&l()}),function(){const e=document.createElement("style");e.textContent="\n      @keyframes fadeInOut {\n        0% { opacity: 0; transform: translateY(20px); }\n        20% { opacity: 1; transform: translateY(0); }\n        80% { opacity: 1; transform: translateY(0); }\n        100% { opacity: 0; transform: translateY(-20px); }\n      }\n    ",document.head.appendChild(e)}(),function(){const e=localStorage.getItem(s);if(e)try{const t=JSON.parse(e),r=new Date(t.timestamp);if((new Date-r)/36e5>24)return void localStorage.removeItem(s);if(confirm("We found a saved draft of your message from "+r.toLocaleString()+". Would you like to restore it?")){if(document.getElementById("name").value=t.name||"",document.getElementById("email").value=t.email||"",document.getElementById("subject").value=t.subject||"",document.getElementById("message").value=t.message||"",a&&o){const e=a.value.length;o.textContent=e+" character"+(1!==e?"s":"")}m("✅ Draft restored successfully!","success"),setTimeout(()=>{n&&(n.style.display="none")},3e3)}else localStorage.removeItem(s)}catch(e){localStorage.removeItem(s)}}())}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d()}();