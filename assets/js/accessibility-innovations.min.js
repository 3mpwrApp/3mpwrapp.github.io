!function(){"use strict";let e=parseInt(localStorage.getItem("spoonCount")||"0");const t=document.getElementById("spoonCount"),n=document.getElementById("resetSpoons");function o(){t&&(t.textContent=e,localStorage.setItem("spoonCount",e))}function c(t=1){e+=t,o()}n&&n.addEventListener("click",function(){e=0,o(),alert("Energy counter reset! 🥄")});let i=Date.now();window.addEventListener("scroll",function(){const e=Date.now();e-i>1e4&&(c(1),i=e)}),document.addEventListener("click",function(){c(.5)}),o();const a=document.getElementById("pageProgressBar"),d=document.getElementById("pageProgressText");function s(){const e=window.innerHeight,t=document.documentElement.scrollHeight,n=(window.pageYOffset||document.documentElement.scrollTop)/(t-e)*100;a&&(a.style.width=Math.min(n,100)+"%"),d&&(d.textContent=Math.round(Math.min(n,100))+"% through page")}window.addEventListener("scroll",s),s();const r=document.getElementById("resumeReadingBtn"),l="savedScrollPosition_"+window.location.pathname;function m(){const e=window.pageYOffset||document.documentElement.scrollTop;e>100&&(localStorage.setItem(l,e),r&&(r.style.display="inline-block"))}let u;window.addEventListener("scroll",function(){clearTimeout(u),u=setTimeout(m,5e3)}),function(){const e=localStorage.getItem(l);e&&r&&(r.style.display="inline-block",r.addEventListener("click",function(){window.scrollTo({top:parseInt(e),behavior:"smooth"}),localStorage.removeItem(l),r.style.display="none"}))}();const g=document.getElementById("needBreakBtn");g&&g.addEventListener("click",function(){const e=document.createElement("div");e.className="break-mode-overlay",e.innerHTML='\n        <div class="break-mode-content">\n          <h2>💙 Taking a Break</h2>\n          <p>You\'re doing great. Rest is productive. This page will be here when you\'re ready.</p>\n          <div class="break-timer" id="breakTimer">5:00</div>\n          <p style="font-size: 1rem; color: #93c5fd;">Breathe deeply. Stretch gently. Hydrate.</p>\n          <button class="break-mode-btn" id="endBreakBtn">I\'m ready to continue</button>\n        </div>\n      ',document.body.appendChild(e);let t=300;const n=document.getElementById("breakTimer"),o=document.getElementById("endBreakBtn"),c=setInterval(function(){t--;const o=Math.floor(t/60),i=t%60;n.textContent=o+":"+(i<10?"0":"")+i,t<=0&&(clearInterval(c),document.body.removeChild(e))},1e3);o.addEventListener("click",function(){clearInterval(c),document.body.removeChild(e)})});const y=document.getElementById("painFlareBtn");y&&(y.addEventListener("click",function(){document.body.classList.toggle("pain-flare-mode");const e=document.body.classList.contains("pain-flare-mode");y.textContent=e?"✅ Pain mode ON":"🔥 Pain flare mode",y.setAttribute("aria-pressed",e),localStorage.setItem("painFlareMode",e)}),"true"===localStorage.getItem("painFlareMode")&&y.click());const h=document.getElementById("overwhelmedBtn");h&&(h.addEventListener("click",function(){document.body.classList.toggle("overwhelmed-mode");const e=document.body.classList.contains("overwhelmed-mode");h.textContent=e?"✅ Simple mode ON":"😰 I'm overwhelmed",h.setAttribute("aria-pressed",e),localStorage.setItem("overwhelmedMode",e)}),"true"===localStorage.getItem("overwhelmedMode")&&h.click());const f=document.getElementById("tooMuchTextBtn");f&&f.addEventListener("click",function(){document.body.classList.toggle("bullets-only-mode");const e=document.body.classList.contains("bullets-only-mode");f.textContent=e?"✅ Bullets only":"📝 Too much text?",f.setAttribute("aria-pressed",e)});const v=document.getElementById("brainFogBtn");v&&v.addEventListener("click",function(){const e=document.querySelector(".brain-fog-summary");if(e)return e.remove(),void(v.textContent="🧠 Brain fog helper");const t=document.createElement("div");t.className="brain-fog-summary",t.innerHTML="3mpwrApp helps injured workers, persons with disabilities, supporters, and allies connect, advocate, and access tools. 100% free, privacy-first, built by the community for the community.";const n=document.querySelector("h1");n&&(n.insertAdjacentElement("afterend",t),v.textContent="✅ Summary showing",t.scrollIntoView({behavior:"smooth",block:"center"}))});const p=document.getElementById("sensoryToggle");if(p){p.addEventListener("change",function(){const e=this.value;switch(document.body.classList.remove("reduced-motion-mode","high-contrast-mode","minimal-mode"),e){case"reduced-motion":document.body.classList.add("reduced-motion-mode"),document.body.style.setProperty("--animation-duration","0s");break;case"high-contrast":document.body.setAttribute("data-contrast","high");break;case"minimal":document.body.classList.add("minimal-mode");break;default:document.body.removeAttribute("data-contrast"),document.body.style.removeProperty("--animation-duration")}localStorage.setItem("sensoryPreference",e)});const e=localStorage.getItem("sensoryPreference");e&&(p.value=e,p.dispatchEvent(new Event("change")))}const b=document.getElementById("readingLevel");if(b){b.addEventListener("change",function(){const e="simple"===this.value;document.body.classList.toggle("simple-language",e),e?(document.querySelectorAll("h2, h3").forEach(function(e){e.style.fontSize="1.25rem"}),document.querySelectorAll("p").forEach(function(e){e.style.fontSize="1.1rem",e.style.lineHeight="1.8"})):document.querySelectorAll("h2, h3, p").forEach(function(e){e.style.fontSize="",e.style.lineHeight=""}),localStorage.setItem("readingLevel",this.value)});const e=localStorage.getItem("readingLevel");e&&(b.value=e,b.dispatchEvent(new Event("change")))}document.querySelectorAll(".email-section-btn").forEach(function(e){e.addEventListener("click",function(){const e=this.getAttribute("data-section"),t=this.parentElement.textContent.substring(0,500),n="3mpwrApp - "+e,o=encodeURIComponent(t+"\n\nRead more at: "+window.location.href);window.location.href="mailto:?subject="+n+"&body="+o})}),setTimeout(function(){const e=(new Date).getHours();if((e>=23||e<5)&&!localStorage.getItem("nightModeSuggested_"+(new Date).toDateString())){const e=document.createElement("div");e.className="time-suggestion",e.innerHTML='\n        <p>🌙 It\'s late - would you like a simpler, easier-on-the-eyes version?</p>\n        <button id="acceptNightMode">Yes, switch to night mode</button>\n        <button id="dismissNightSuggestion">No thanks</button>\n      ';const t=document.querySelector("h1");t&&(t.insertAdjacentElement("beforebegin",e),document.getElementById("acceptNightMode").addEventListener("click",function(){document.body.setAttribute("data-theme","dark"),p&&(p.value="minimal"),e.remove(),localStorage.setItem("nightModeSuggested_"+(new Date).toDateString(),"true")}),document.getElementById("dismissNightSuggestion").addEventListener("click",function(){e.remove(),localStorage.setItem("nightModeSuggested_"+(new Date).toDateString(),"true")}))}},2e3),window.enableVoiceFatigueMode=function(){document.body.classList.add("voice-fatigue-mode"),localStorage.setItem("voiceFatigueMode","true")},"true"===localStorage.getItem("voiceFatigueMode")&&enableVoiceFatigueMode(),document.querySelectorAll(".energy-cost").forEach(function(e){const t=parseInt(e.getAttribute("data-energy")||"1");new IntersectionObserver(function(n){n.forEach(function(n){n.isIntersecting&&!e.dataset.counted&&(c(t),e.dataset.counted="true")})},{threshold:.5}).observe(e.parentElement)}),document.addEventListener("keydown",function(e){e.altKey&&"b"===e.key&&(e.preventDefault(),g&&g.click()),e.altKey&&"p"===e.key&&(e.preventDefault(),y&&y.click()),e.altKey&&"o"===e.key&&(e.preventDefault(),h&&h.click()),e.altKey&&"s"===e.key&&(e.preventDefault(),n&&n.click())})}();